<!--pages/org-apply/org-apply.wxml-->
<view class="page-container">
  <!-- 顶部固定区域：标题 -->
  <view class="header" style="padding-top: {{statusBarHeight}}px;">
    <view class="header-content">
      <view class="back-button" bindtap="onBackTap">
        <t-icon name="chevron-left" size="52rpx" color="#1a1a1a" />
      </view>
      <!-- 标题栏 -->
      <view class="title-bar">
        <text class="app-title">完善申请信息</text>
      </view>
    </view>
  </view>

  <!-- 占位高度 -->
  <view style="height: calc({{statusBarHeight}}px + 108rpx);"></view>

  <view class="content">
    <text class="page-title font-serif">完善信息</text>

    <view class="form-section">
      <!-- 机构类型（只读） -->
      <view class="form-row form-row--readonly">
        <text class="form-label font-serif">机构类型</text>
        <view class="form-value-wrap">
          <text class="form-value">{{typeName}}</text>
          <text class="change-btn" bindtap="onChangeType">更改</text>
        </view>
      </view>

      <!-- 机构名称 -->
      <view class="form-row">
        <input 
          class="form-input" 
          placeholder="机构名称"
          value="{{formData.orgName}}"
          bindinput="onOrgNameInput"
        />
      </view>

      <!-- 联系人 -->
      <view class="form-row">
        <input 
          class="form-input" 
          placeholder="联系人"
          value="{{formData.contact}}"
          bindinput="onContactInput"
        />
      </view>

      <!-- 联系电话 -->
      <view class="form-row">
        <input 
          class="form-input" 
          type="number"
          placeholder="联系电话"
          value="{{formData.phone}}"
          bindinput="onPhoneInput"
        />
      </view>

      <!-- 详细地址 -->
      <view class="form-row form-row--address">
        <input 
          class="form-input" 
          placeholder="详细地址"
          value="{{formData.address}}"
          bindinput="onAddressInput"
        />
        <view class="address-btn" bindtap="onChooseLocation">
          <t-icon name="location" size="40rpx" color="#9CA3AF" />
        </view>
      </view>

      <!-- 机构简介 -->
      <view class="form-row form-row--textarea">
        <text class="textarea-label">机构简介</text>
        <textarea 
          class="form-textarea" 
          placeholder="请简要描述您的机构..."
          value="{{formData.description}}"
          bindinput="onDescInput"
        />
      </view>
    </view>

    <!-- 图片上传 -->
    <view class="upload-section">
      <view class="upload-header">
        <text class="upload-title font-serif">图片与封面</text>
        <text class="upload-tip">最多6张图片</text>
      </view>
      <view class="upload-list">
        <view 
          wx:for="{{images}}" 
          wx:key="index" 
          class="upload-item upload-item--image"
        >
          <image src="{{item}}" mode="aspectFill" />
          <view class="remove-btn" bindtap="onRemoveImage" data-index="{{index}}">
            <t-icon name="close" size="24rpx" color="#fff" />
          </view>
        </view>
        <view 
          wx:if="{{images.length < 6}}" 
          class="upload-item upload-item--add"
          bindtap="onChooseImage"
        >
          <t-icon name="add" size="48rpx" color="#D1D5DB" />
          <text class="upload-text">上传</text>
        </view>
      </view>
    </view>

    <view class="submit-btn" bindtap="onSubmit">
      <text>提交申请</text>
    </view>
  </view>
</view>
