# 永定研学小程序 - 开发任务进度跟踪

## 项目概述
基于微信小程序原生 + TDesign UI + TypeScript 开发永定研学小程序前端页面。

## 任务分解

### 阶段一：项目初始化与基础配置 ✅
- [x] 1.1 创建小程序项目基础目录结构
- [x] 1.2 配置 app.json（页面路由、tabBar、全局组件）
- [x] 1.3 配置 app.ts 和全局样式（主题色、TDesign覆盖）
- [x] 1.4 创建公共类型定义文件（typings）
- [x] 1.5 创建 Mock 数据文件

### 阶段二：公共组件开发 ✅
- [x] 2.1 nav-bar 自定义导航栏组件
- [x] 2.2 bottom-action-bar 底部悬浮操作栏组件
- [x] 2.3 course-card 课程卡片组件
- [x] 2.4 route-card 线路卡片组件
- [x] 2.5 base-card 基地卡片组件
- [x] 2.6 expert-card 导师卡片组件
- [x] 2.7 expandable-text 展开/收起文本组件
- [x] 2.8 timeline 时间轴组件
- [x] 2.9 function-grid 功能入口网格组件
- [x] 2.10 district-tags 乡镇标签组件
- [x] 2.11 empty-state 空状态组件

### 阶段三：首页开发 ✅
- [x] 3.1 首页基础布局与头部搜索栏
- [x] 3.2 Banner 轮播图模块
- [x] 3.3 功能入口网格模块
- [x] 3.4 乡镇街道标签模块
- [x] 3.5 热门课程列表模块
- [x] 3.6 热门线路列表模块
- [x] 3.7 研学营地横向滚动模块

### 阶段四：课程模块开发 ✅
- [x] 4.1 课程列表页基础布局与分类筛选
- [x] 4.2 课程列表数据加载与展示
- [x] 4.3 课程详情页基础布局
- [x] 4.4 课程详情页 Tab 切换（详情/安排/费用）
- [x] 4.5 课程详情页底部操作栏

### 阶段五：线路模块开发 ✅
- [x] 5.1 线路列表页基础布局与分类筛选
- [x] 5.2 线路列表数据加载与展示
- [x] 5.3 线路详情页基础布局
- [x] 5.4 线路详情页 Tab 切换与机构信息
- [x] 5.5 线路详情页底部操作栏

### 阶段六：基地与机构模块开发 ✅
- [x] 6.1 基地/机构列表页 Tab 切换布局
- [x] 6.2 基地列表数据加载与展示
- [x] 6.3 机构列表数据加载与展示
- [x] 6.4 基地详情页开发
- [x] 6.5 机构详情页开发

### 阶段七：导师模块开发 ✅
- [x] 7.1 导师列表页基础布局与搜索
- [x] 7.2 导师分类筛选与列表展示

### 阶段八：个人中心开发 ✅
- [x] 8.1 个人中心页面基础布局
- [x] 8.2 用户信息展示与签到功能
- [x] 8.3 推广卡片与功能列表
- [x] 8.4 收藏课程功能（本地存储 + 收藏列表页）

### 阶段九：搜索功能开发 ✅
- [x] 9.1 搜索页面开发

### 阶段十：导师详情与申请模块开发 ✅
- [x] 10.1 导师详情页开发（expert-detail）
- [x] 10.2 申请导师页面开发（apply-mentor）
- [x] 10.3 加入我们选择页面开发（join-selection）
- [x] 10.4 机构申请页面开发（org-apply）

### 阶段十A：前端遗留问题修复 ✅
- [x] 10A.1 修复机构详情页导航功能（agency-detail onNavigateTap 使用 location 字段实现导航）
- [x] 10A.2 修复机构详情页导师点击跳转（agency-detail onExpertTap 跳转到 expert-detail 页面）
- [x] 10A.3 移除线路详情页收藏按钮或改为仅 UI 展示（route-detail 收藏不持久化，仅保留课程收藏）
- [x] 10A.4 课程详情页图片轮播功能（imageUrl 改为 images 数组，支持多图轮播展示）
- [x] 10A.5 线路详情页图片轮播功能（imageUrl 改为 images 数组，支持多图轮播展示）
- [x] 10A.6 基地详情页图片轮播功能（imageUrl 改为 images 数组，支持多图轮播展示）
- [x] 10A.7 更新 Mock 数据结构（courses/routes/bases 的 imageUrl 字段改为 images 数组）
- [x] 10A.8 更新类型定义文件（typings/models.d.ts 中 ICourse/IRoute/IBase 添加 images 字段）

### 阶段十B：用户登录注册功能 ✅
- [x] 10B.1 初始化云开发环境（env: cloud1-3g4bg132953c87fa）
- [x] 10B.2 创建 login 云函数获取用户 OpenId
- [x] 10B.3 创建 services/user.ts 用户服务（登录、注册、签到、退出）
- [x] 10B.4 更新个人中心页面支持真实登录功能
- [x] 10B.5 实现用户签到功能（连续签到天数统计）
- [x] 10B.6 更新 IAppOption 类型定义

## 当前进行中

**用户登录注册功能开发完成！**

---

## 待完成任务

### 阶段十一：数据库与接口文档设计 🔲
- [ ] 11.1 创建 Documentation/database.md 文档框架
- [ ] 11.2 设计 courses 课程集合字段与接口
- [ ] 11.3 设计 routes 线路集合字段与接口
- [ ] 11.4 设计 bases 基地集合字段与接口
- [ ] 11.5 设计 agencies 机构集合字段与接口
- [ ] 11.6 设计 experts 导师集合字段与接口
- [ ] 11.7 设计 users 用户集合字段与接口
- [ ] 11.8 设计 favorites 收藏集合字段与接口
- [ ] 11.9 设计 banners 轮播图集合字段与接口
- [ ] 11.10 设计 applications 申请集合字段与接口（导师申请/机构入驻）
- [ ] 11.11 设计索引规则与数据关联关系

### 阶段十二：云开发环境与数据库初始化 🔲
- [ ] 12.1 开通微信云开发环境
- [ ] 12.2 配置 project.config.json 云开发设置
- [ ] 12.3 创建 courses 数据库集合
- [ ] 12.4 创建 routes 数据库集合
- [ ] 12.5 创建 bases 数据库集合
- [ ] 12.6 创建 agencies 数据库集合
- [ ] 12.7 创建 experts 数据库集合
- [ ] 12.8 创建 users 数据库集合
- [ ] 12.9 创建 favorites 数据库集合
- [ ] 12.10 创建 banners 数据库集合
- [ ] 12.11 配置数据库索引
- [ ] 12.12 配置数据库安全规则
- [ ] 12.13 导入初始测试数据（courses）
- [ ] 12.14 导入初始测试数据（routes）
- [ ] 12.15 导入初始测试数据（bases + agencies）
- [ ] 12.16 导入初始测试数据（experts）
- [ ] 12.17 导入初始测试数据（banners）
- [ ] 12.18 创建 applications 数据库集合

### 阶段十三：云函数基础架构 🔲
- [ ] 13.1 创建 cloudfunctions 目录结构
- [ ] 13.2 创建公共工具函数（_shared/utils.js）
- [ ] 13.3 创建统一响应格式封装
- [ ] 13.4 创建数据库操作基类封装

### 阶段十四：课程云函数开发 🔲
- [ ] 14.1 创建 course 云函数基础结构
- [ ] 14.2 实现 getList 获取课程列表接口
- [ ] 14.3 实现 getDetail 获取课程详情接口
- [ ] 14.4 实现 getByCategory 按分类筛选接口
- [ ] 14.5 实现 search 课程搜索接口
- [ ] 14.6 实现 getHot 获取热门课程接口

### 阶段十五：线路云函数开发 🔲
- [ ] 15.1 创建 route 云函数基础结构
- [ ] 15.2 实现 getList 获取线路列表接口
- [ ] 15.3 实现 getDetail 获取线路详情接口
- [ ] 15.4 实现 getByCategory 按分类筛选接口
- [ ] 15.5 实现 search 线路搜索接口
- [ ] 15.6 实现 getHot 获取热门线路接口

### 阶段十六：基地与机构云函数开发 🔲
- [ ] 16.1 创建 base 云函数基础结构
- [ ] 16.2 实现 getList 获取基地列表接口
- [ ] 16.3 实现 getDetail 获取基地详情接口
- [ ] 16.4 实现 getByDistrict 按乡镇筛选接口
- [ ] 16.5 创建 agency 云函数基础结构
- [ ] 16.6 实现 getList 获取机构列表接口
- [ ] 16.7 实现 getDetail 获取机构详情接口

### 阶段十七：导师云函数开发 🔲
- [ ] 17.1 创建 expert 云函数基础结构
- [ ] 17.2 实现 getList 获取导师列表接口
- [ ] 17.3 实现 getDetail 获取导师详情接口
- [ ] 17.4 实现 getByRole 按角色筛选接口
- [ ] 17.5 实现 search 导师搜索接口

### 阶段十八：用户与收藏云函数开发 🔲
- [ ] 18.1 创建 user 云函数基础结构
- [ ] 18.2 实现 login 用户登录接口
- [ ] 18.3 实现 getUserInfo 获取用户信息接口
- [ ] 18.4 实现 updateUserInfo 更新用户信息接口
- [ ] 18.5 创建 favorite 云函数基础结构
- [ ] 18.6 实现 add 添加收藏接口
- [ ] 18.7 实现 remove 取消收藏接口
- [ ] 18.8 实现 getList 获取收藏列表接口
- [ ] 18.9 实现 check 检查收藏状态接口

### 阶段十九：首页与搜索云函数开发 🔲
- [ ] 19.1 创建 home 云函数基础结构
- [ ] 19.2 实现 getBanners 获取轮播图接口
- [ ] 19.3 实现 getHomeData 获取首页聚合数据接口
- [ ] 19.4 创建 search 云函数基础结构
- [ ] 19.5 实现 searchAll 全局搜索接口（课程+线路+基地）

### 阶段十九A：申请云函数开发 🔲
- [ ] 19A.1 创建 application 云函数基础结构
- [ ] 19A.2 实现 submitMentorApplication 提交导师申请接口
- [ ] 19A.3 实现 submitOrgApplication 提交机构入驻申请接口
- [ ] 19A.4 实现 getMyApplications 获取我的申请列表接口
- [ ] 19A.5 实现 getApplicationDetail 获取申请详情接口

### 阶段二十：前端 Services 层封装 🔲
- [ ] 20.1 创建 services/api.ts 基础请求封装
- [ ] 20.2 创建 services/course.ts 课程服务
- [ ] 20.3 创建 services/route.ts 线路服务
- [ ] 20.4 创建 services/base.ts 基地服务
- [ ] 20.5 创建 services/agency.ts 机构服务
- [ ] 20.6 创建 services/expert.ts 导师服务
- [ ] 20.7 创建 services/user.ts 用户服务
- [ ] 20.8 更新 services/favorite.ts 对接云函数
- [ ] 20.9 创建 services/home.ts 首页服务
- [ ] 20.10 创建 services/search.ts 搜索服务
- [ ] 20.11 创建 services/application.ts 申请服务

### 阶段二十一：前端页面对接云函数 🔲
- [ ] 21.1 首页对接云函数数据
- [ ] 21.2 课程列表页对接云函数
- [ ] 21.3 课程详情页对接云函数
- [ ] 21.4 线路列表页对接云函数
- [ ] 21.5 线路详情页对接云函数
- [ ] 21.6 基地列表页对接云函数
- [ ] 21.7 基地详情页对接云函数
- [ ] 21.8 机构详情页对接云函数
- [ ] 21.9 导师列表页对接云函数
- [ ] 21.10 导师详情页对接云函数
- [ ] 21.11 搜索页对接云函数
- [ ] 21.12 收藏功能对接云函数
- [ ] 21.13 个人中心对接云函数
- [ ] 21.14 申请导师页面对接云函数（apply-mentor）
- [ ] 21.15 机构申请页面对接云函数（org-apply）

### 阶段二十二：CMS后台管理系统（待定）🔲
- [ ] 22.1 技术选型与项目初始化
- [ ] 22.2 登录与权限管理
- [ ] 22.3 课程管理模块
- [ ] 22.4 线路管理模块
- [ ] 22.5 基地管理模块
- [ ] 22.6 机构管理模块
- [ ] 22.7 导师管理模块
- [ ] 22.8 用户管理模块
- [ ] 22.9 首页配置管理（Banner等）
- [ ] 22.10 数据统计与报表

---

## 组件清单

| 组件名 | 路径 | 用途 |
|-------|------|------|
| nav-bar | components/nav-bar | 自定义导航栏 |
| bottom-action-bar | components/bottom-action-bar | 底部悬浮操作栏 |
| course-card | components/course-card | 课程卡片 |
| route-card | components/route-card | 线路卡片 |
| base-card | components/base-card | 基地卡片 |
| expert-card | components/expert-card | 导师卡片 |
| expandable-text | components/expandable-text | 展开/收起文本 |
| timeline | components/timeline | 时间轴 |
| function-grid | components/function-grid | 功能入口网格 |
| district-tags | components/district-tags | 乡镇标签 |
| empty-state | components/empty-state | 空状态 |

---

## 更新日志

| 日期 | 任务编号 | 任务内容 | 状态 |
|------|---------|---------|------|
| 2025-12-05 | 1.1~1.5 | 项目初始化与基础配置 | ✅ 完成 |
| 2025-12-05 | 2.1 | nav-bar 自定义导航栏组件 | ✅ 完成 |
| 2025-12-05 | 2.2 | bottom-action-bar 底部悬浮操作栏组件 | ✅ 完成 |
| 2025-12-05 | 2.3 | course-card 课程卡片组件 | ✅ 完成 |
| 2025-12-05 | 2.4 | route-card 线路卡片组件 | ✅ 完成 |
| 2025-12-05 | 2.5 | base-card 基地卡片组件 | ✅ 完成 |
| 2025-12-05 | 2.6 | expert-card 导师卡片组件 | ✅ 完成 |
| 2025-12-05 | 2.7 | expandable-text 展开/收起文本组件 | ✅ 完成 |
| 2025-12-05 | 2.8 | timeline 时间轴组件 | ✅ 完成 |
| 2025-12-05 | 2.9 | function-grid 功能入口网格组件 | ✅ 完成 |
| 2025-12-05 | 2.10 | district-tags 乡镇标签组件 | ✅ 完成 |
| 2025-12-05 | 2.11 | empty-state 空状态组件 | ✅ 完成 |
| 2025-12-05 | 3.1~3.7 | 首页完整开发（布局、Banner、功能入口、乡镇标签、热门课程/线路/基地） | ✅ 完成 |
| 2025-12-05 | 4.1~4.2 | 课程列表页（分类筛选、数据加载、下拉刷新、上拉加载） | ✅ 完成 |
| 2025-12-05 | 4.3~4.5 | 课程详情页（基础布局、Tab切换、底部操作栏） | ✅ 完成 |
| 2025-12-05 | 5.1~5.5 | 线路模块（列表页分类筛选、详情页Tab切换、机构信息卡片） | ✅ 完成 |
| 2025-12-05 | 6.1~6.5 | 基地与机构模块（Tab切换、基地/机构列表、详情页） | ✅ 完成 |
| 2025-12-05 | 7.1~7.2 | 导师模块（列表页搜索、分类筛选、导师卡片展示） | ✅ 完成 |
| 2025-12-05 | 8.1~8.3 | 个人中心（用户信息、签到功能、推广卡片、功能菜单） | ✅ 完成 |
| 2025-12-07 | 8.4 | 收藏课程功能（favorite服务、收藏列表页、课程详情页收藏集成） | ✅ 完成 |
| 2025-12-07 | 10.1~10.4 | 导师详情与申请模块（导师详情页、申请导师、加入我们选择、机构申请） | ✅ 完成 |
| 2025-12-07 | 9.1 | 搜索功能（热门搜索、历史记录、课程/线路/基地搜索） | ✅ 完成 |
| 2025-12-08 | 10A.1~10A.8 | 前端遗留问题修复（导航功能、导师跳转、图片轮播、类型定义更新） | ✅ 完成 |
| 2025-12-08 | 10B.1~10B.6 | 用户登录注册功能（云开发初始化、login云函数、用户服务、签到功能） | ✅ 完成 |
